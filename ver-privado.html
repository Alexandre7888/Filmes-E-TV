<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Cat√°logo Privado</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .card { border: 1px solid #ccc; padding: 10px; margin-bottom: 15px; }
    h2 { margin-top: 40px; }
    .btn { background: #4CAF50; color: white; padding: 10px; border: none; cursor: pointer; }
  </style>
</head>
<body>
  <h1>üéûÔ∏è Cat√°logo Privado</h1>
  <div id="conteudo"><p>Carregando...</p></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC4THzGt-8NwPDmWuaqR4OTJR_6XbfbSvM",
      authDomain: "api7-5cde7.firebaseapp.com",
      databaseURL: "https://api7-5cde7-default-rtdb.firebaseio.com",
      projectId: "api7-5cde7",
      storageBucket: "api7-5cde7.appspot.com",
      messagingSenderId: "113015470459",
      appId: "1:113015470459:web:3ffd77031fb936d001a5de"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const token = new URLSearchParams(location.search).get("token");
    const conteudo = document.getElementById("conteudo");

    if (!token) {
      conteudo.innerHTML = "<h2 style='color:red;'>‚ùå Token n√£o informado.</h2>";
    } else {
      const refToken = ref(db, "conteudos/" + token);
      get(refToken).then(snap => {
        if (!snap.exists()) {
          conteudo.innerHTML = "<h2 style='color:red;'>‚ùå Token inv√°lido ou sem conte√∫do.</h2>";
          return;
        }
        const dados = snap.val();
        carregarCategoria(dados.filmes, "üé¨ Filmes");
        carregarCategoria(dados.series, "üì∫ S√©ries");
        carregarCategoria(dados.tv, "üì° TV");
      });
    }

    function carregarCategoria(lista, titulo) {
      if (!lista) return;
      const secao = document.createElement("div");
      secao.innerHTML = `<h2>${titulo}</h2>`;
      for (let id in lista) {
        const item = lista[id];
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <h3>${item.titulo}</h3>
          <button class="btn" onclick="window.open('${item.link}', '_blank')">‚ñ∂ Assistir</button>
        `;
        secao.appendChild(card);
      }
      conteudo.appendChild(secao);
    }
  </script>
</body>
</html>