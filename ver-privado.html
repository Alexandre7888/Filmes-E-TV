<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cat√°logo</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f4f6f9;
      color: #333;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 30px;
    }

    input[type="text"] {
      padding: 12px;
      width: 100%;
      max-width: 500px;
      margin: 0 auto 30px;
      display: block;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }

    .secao {
      margin-bottom: 40px;
    }

    .secao h2 {
      font-size: 22px;
      color: #34495e;
      border-left: 6px solid #4CAF50;
      padding-left: 10px;
      margin-bottom: 15px;
    }

    .card {
      display: flex;
      background: white;
      border-radius: 12px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
      overflow: hidden;
      margin-bottom: 20px;
      transition: transform 0.2s ease;
    }

    .card:hover {
      transform: scale(1.01);
    }

    .card img {
      width: 140px;
      height: auto;
      object-fit: cover;
      border-right: 1px solid #eee;
    }

    .info {
      padding: 15px;
      flex: 1;
    }

    .info h3 {
      margin-top: 0;
      font-size: 20px;
      color: #2c3e50;
    }

    .info p {
      margin: 6px 0;
      font-size: 14px;
      color: #555;
    }

    .info .generos span {
      display: inline-block;
      margin-right: 8px;
    }

    .info button {
      margin-top: 10px;
      padding: 10px 16px;
      background: #4CAF50;
      color: white;
      border: none;
      font-size: 15px;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>üéûÔ∏è Cat√°logo de Conte√∫do</h1>
  <input type="text" id="pesquisa" placeholder="üîç Pesquise por t√≠tulo, autor ou g√™nero...">
  <div id="conteudo"><p>Carregando...</p></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC4THzGt-8NwPDmWuaqR4OTJR_6XbfbSvM",
      authDomain: "api7-5cde7.firebaseapp.com",
      databaseURL: "https://api7-5cde7-default-rtdb.firebaseio.com",
      projectId: "api7-5cde7",
      storageBucket: "api7-5cde7.appspot.com",
      messagingSenderId: "113015470459",
      appId: "1:113015470459:web:3ffd77031fb936d001a5de"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const conteudo = document.getElementById("conteudo");

    let todosItens = [];

    async function carregar() {
      conteudo.innerHTML = "";
      await carregarCategoria("filmes", "üé¨ Filmes");
      await carregarCategoria("series", "üì∫ S√©ries");
      await carregarCategoria("tv", "üì° TV Ao Vivo");
    }

    async function carregarCategoria(caminho, titulo) {
      const snap = await get(ref(db, caminho));
      if (snap.exists()) {
        const dados = snap.val();
        const secao = document.createElement("div");
        secao.className = "secao";
        secao.innerHTML = `<h2>${titulo}</h2>`;

        for (const id in dados) {
          const item = dados[id];
          todosItens.push(item); // Armazena para pesquisa

          const card = document.createElement("div");
          card.className = "card";

          const capa = item.capa ? `<img src="${item.capa}" alt="Capa">` : "";

          const generos = item.genero
            ? item.genero.split(",").map(g => `<span>‚Ä¢ ${g.trim()}</span>`).join(" ")
            : "";

          const autor = item.autor || "";

          card.innerHTML = `
            ${capa}
            <div class="info">
              <h3>${item.titulo || "Sem T√≠tulo"}</h3>
              ${generos ? `<p class="generos">${generos}</p>` : ""}
              ${autor ? `<p><strong>Autor:</strong> ${autor}</p>` : ""}
              <a href="${item.link}" target="_blank"><button>‚ñ∂ Assistir</button></a>
            </div>
          `;
          secao.appendChild(card);
        }

        conteudo.appendChild(secao);
      }
    }

    // Pesquisa
    document.getElementById("pesquisa").addEventListener("input", function () {
      const termo = this.value.toLowerCase();
      conteudo.innerHTML = "";

      const filtrados = todosItens.filter(item => {
        const titulo = item.titulo?.toLowerCase() || "";
        const genero = item.genero?.toLowerCase() || "";
        const autor = item.autor?.toLowerCase() || "";
        return titulo.includes(termo) || genero.includes(termo) || autor.includes(termo);
      });

      const secao = document.createElement("div");
      secao.className = "secao";
      secao.innerHTML = `<h2>üîç Resultados da busca</h2>`;

      for (const item of filtrados) {
        const card = document.createElement("div");
        card.className = "card";

        const capa = item.capa ? `<img src="${item.capa}" alt="Capa">` : "";

        const generos = item.genero
          ? item.genero.split(",").map(g => `<span>‚Ä¢ ${g.trim()}</span>`).join(" ")
          : "";

        const autor = item.autor || "";

        card.innerHTML = `
          ${capa}
          <div class="info">
            <h3>${item.titulo || "Sem T√≠tulo"}</h3>
            ${generos ? `<p class="generos">${generos}</p>` : ""}
            ${autor ? `<p><strong>Autor:</strong> ${autor}</p>` : ""}
            <a href="${item.link}" target="_blank"><button>‚ñ∂ Assistir</button></a>
          </div>
        `;
        secao.appendChild(card);
      }

      if (filtrados.length === 0) {
        conteudo.innerHTML = "<p>Nenhum resultado encontrado.</p>";
      } else {
        conteudo.appendChild(secao);
      }
    });

    carregar();
  </script>
</body>
</html>